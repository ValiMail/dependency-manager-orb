description: >
  Restore, install, and cache JS packages using Yarn

parameters:
  cache-version:
    description: Version prefix to use in cache key
    type: string
    default: v1

  node-modules-path:
    description: Path to store packages
    type: string
    default: node_modules

  restore-cache:
    type: boolean
    default: true

  install-packages:
    type: boolean
    default: true

  save-cache:
    type: boolean
    default: true

steps:
  - when:
      condition: << parameters.restore-cache >>
      steps:
        - restore-node-cache:
            cache-version: << parameters.cache-version >>

  - when:
      condition: << parameters.install-packages >>
      steps:
        - run:
            name: Install node packages
            command: yarn

  - when:
      condition: << parameters.save-cache >>
      steps:
        - save-node-cache:
            cache-version: << parameters.cache-version >>
