description: >
  Creates cache of rubygems in vendor/cache folder and installs gems to BUNDLE_PATH afterwards

parameters:
  bundle-path:
    description: Path to store gems bundle
    type: string
    default: vendor/bundle

  cache-version:
    description: Version prefix to use in cache key
    type: string
    default: v1

steps:
  - run:
      name: Install gems
      command: |
        export BUNDLE_JOBS=4
        export BUNDLE_PATH=<< parameters.bundle-path >>
        bundle lock && bundle package --all
